<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link rel="stylesheet" href="../css/add.css" />
        <link rel="stylesheet" href="../css/my.css" />
    </head>
    <body>
        <img src="../assets/booticon.png" />
        <h1>Add Player</h1>
        <div class="formdiv">
            <form name="form1" class="formdiv">
                <div class="innerDiv">
                    Name<input class="inputText" type="text" name="name" id="name" />
                    <div id="error-message-name" class="error-message">Name is required</div>
                </div>

                <div class="innerDiv">
                    Birth Year<input class="inputText" type="number" name="birthyear" id="birthyear" />
                    <div id="error-message-birthyear" class="error-message">
                        Birth year must be a valid year below 2024
                    </div>
                </div>

                <div class="innerDiv">
                    Club<input class="inputText" type="text" name="club" id="club" />
                    <div id="error-message-club" class="error-message">Club is required</div>
                </div>
                <div class="innerDiv">
                    Country<input class="inputText" type="text" name="country" id="country" />
                    <div id="error-message-country" class="error-message">
                        Country must be at least 2 characters long
                    </div>
                </div>

                <div class="innerDiv">
                    Position<input class="inputText" type="text" name="position" id="position" />
                    <div id="error-message-position" class="error-message">Position must be GK, DF, MF, or FW</div>
                </div>
                <div class="innerDiv">
                    Main Foot<input class="inputText" type="text" name="mainfoot" id="mainfoot" />
                    <div id="error-message-mainfoot" class="error-message">Main foot is required</div>
                </div>
                <button type="button" id="btn" onclick="handleSubmit()" onmouseover="mouseon()" onmouseout="mouseout()">
                    Continue to checkout
                </button>
            </form>
        </div>
        <!-- <script src="../js/add.js" defer></script> -->
        <script>
            const nameInput = document.getElementById("name");
            const birthYearInput = document.getElementById("birthyear");
            const countryInput = document.getElementById("country");
            const positionInput = document.getElementById("position");
            const clubInput = document.getElementById("club");
            const mainFootInput = document.getElementById("mainfoot");
            const myButton = document.getElementById("btn");

            const errorMessageName = document.getElementById("error-message-name");
            const errorMessageBirthYear = document.getElementById("error-message-birthyear");
            const errorMessageCountry = document.getElementById("error-message-country");
            const errorMessagePosition = document.getElementById("error-message-position");
            const errorMessageClub = document.getElementById("error-message-club");
            const errorMessageMainFoot = document.getElementById("error-message-mainfoot");

            // 공통 유효성 검사 함수
            function validateField(input, errorMessage, customValidation = null) {
                const value = input.value.trim();
                if (!value || (customValidation && !customValidation(value))) {
                    input.classList.add("error");
                    input.classList.remove("success");
                    errorMessage.classList.add("active");
                    return false;
                } else {
                    input.classList.remove("error");
                    input.classList.add("success");
                    errorMessage.classList.remove("active");
                    return true;
                }
            }

            // Birth Year에 대한 커스텀 유효성 검사 함수
            function validateBirthYear(value) {
                const year = parseInt(value, 10);
                return !isNaN(year) && year > 0 && year < 2024;
            }

            // Country에 대한 커스텀 유효성 검사 함수
            function validateCountry(value) {
                return value.length >= 2;
            }

            // Position에 대한 커스텀 유효성 검사 함수
            function validatePosition(value) {
                const validPositions = ["GK", "DF", "MF", "FW"];
                return validPositions.includes(value.toUpperCase());
            }

            // 전체 폼 유효성 검사
            function isValid() {
                let isValid = true;

                isValid = validateField(nameInput, errorMessageName) && isValid;
                isValid = validateField(birthYearInput, errorMessageBirthYear, validateBirthYear) && isValid;
                isValid = validateField(countryInput, errorMessageCountry, validateCountry) && isValid;
                isValid = validateField(positionInput, errorMessagePosition, validatePosition) && isValid;
                isValid = validateField(clubInput, errorMessageClub) && isValid;
                isValid = validateField(mainFootInput, errorMessageMainFoot) && isValid;

                return isValid;
            }

            // 폼 제출 처리
            function handleSubmit() {
                if (isValid()) {
                    document.form1.submit();
                    alert("Submit success");
                }
            }

            // 마우스 hover 이벤트 처리
            function mouseon() {
                myButton.classList.add("mouseOn");
            }

            function mouseout() {
                myButton.classList.remove("mouseOn");
            }

            // 실시간 입력 유효성 검사
            nameInput.addEventListener("input", () => {
                validateField(nameInput, errorMessageName);
            });

            birthYearInput.addEventListener("input", () => {
                validateField(birthYearInput, errorMessageBirthYear, validateBirthYear);
            });

            countryInput.addEventListener("input", () => {
                validateField(countryInput, errorMessageCountry, validateCountry);
            });

            positionInput.addEventListener("input", () => {
                validateField(positionInput, errorMessagePosition, validatePosition);
            });

            clubInput.addEventListener("input", () => {
                validateField(clubInput, errorMessageClub);
            });

            mainFootInput.addEventListener("input", () => {
                validateField(mainFootInput, errorMessageMainFoot);
            });
        </script>
    </body>
</html>
